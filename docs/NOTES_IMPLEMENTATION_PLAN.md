# План імплементації функціоналу нотаток для проєкту "Розрахуй і В'яжи"

## Поточний стан

У поточній версії додатку реалізовано просту версію нотаток без форматування тексту та медіа-контенту. Це базова реалізація, яка дозволяє користувачам вводити текстові нотатки та зберігати їх в локальній базі даних WatermelonDB.

## Проблеми з нативними модулями

Спроба реалізувати розширену версію редактора нотаток з форматуванням тексту, зображеннями та відео з YouTube зіткнулася з наступними проблемами:

1. **Конфлікти плагінів Gradle** при спробі інтеграції `react-native-rich-editor` та інших нативних модулів. Помилка:
   ```
   'com.android.library' and 'com.android.application' plugins cannot be applied in the same project.
   ```

2. **Проблеми з версіями бібліотек Expo** при спробі встановлення різних нативних модулів. Помилка:
   ```
   Plugin [id: 'expo-module-gradle-plugin'] was not found
   ```

3. **Проблеми з сумісністю бібліотек** з стеком проєкту (Expo, React Native, Supabase, WatermelonDB).

## План реалізації функціоналу нотаток

### Етап 1: Технічний аудит та виправлення конфліктів

1. **Оновлення Expo SDK та React Native**
   - Перевірити сумісність всіх залежностей
   - Оновити конфігурацію Gradle для вирішення конфліктів плагінів

2. **Створення окремого модуля для редактора нотаток**
   - Створити окремий npm-модуль для редактора нотаток
   - Налаштувати його сумісність з наявними версіями Expo та React Native

### Етап 2: Реалізація редактора з форматуванням тексту

1. **WebView-базований редактор**
   - Створити власний WebView-базований редактор з використанням JavaScript
   - Реалізувати базові операції форматування (жирний, курсив, списки)

2. **Комунікація між WebView та React Native**
   - Реалізувати механізми передачі даних між WebView та React Native
   - Забезпечити безпечний механізм стану та оновлення даних

### Етап 3: Реалізація підтримки медіа-контенту

1. **Вставка зображень**
   - Використання `expo-image-picker` для вибору зображень
   - Реалізація зберігання зображень локально з використанням `expo-file-system`

2. **Відео з YouTube**
   - Реалізація механізму вставки відео з YouTube
   - Забезпечення офлайн-режиму з заглушками для відео

### Етап 4: Синхронізація даних та офлайн-підтримка

1. **Оптимізація зберігання в WatermelonDB**
   - Реалізація ефективного зберігання HTML-контенту в базі даних
   - Оптимізація розміру даних для зберігання в базі даних

2. **Синхронізація з Supabase**
   - Реалізація синхронізації нотаток з сервером при наявності мережі
   - Вирішення конфліктів при синхронізації

## Часова оцінка етапів

1. Етап 1: 1-2 тижні
2. Етап 2: 2-3 тижні
3. Етап 3: 2-3 тижні
4. Етап 4: 1-2 тижні

Загалом: 6-10 тижнів залежно від складності вирішення конфліктів з нативними модулями.

## Рекомендації

1. **Тимчасове рішення**
   - Використовувати спрощену реалізацію нотаток з TextInput до вирішення проблем з нативними модулями

2. **Окремий модуль**
   - Розробити редактор нотаток як окремий модуль з власним налаштуванням Gradle

3. **Зкоординувати оновлення залежностей**
   - Перевірити та оновити всі залежності Expo, React Native та нативних модулів до сумісних версій